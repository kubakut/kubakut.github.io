"undefined"==typeof leafletActiveAreaPreviousMethods&&(leafletActiveAreaPreviousMethods={getCenter:L.Map.prototype.getCenter,setView:L.Map.prototype.setView,setZoomAround:L.Map.prototype.setZoomAround,getBoundsZoom:L.Map.prototype.getBoundsZoom}),L.Map.include({getViewport:function(){return this._viewport},getViewportBounds:function(){var t=this._viewport,e=L.point(t.offsetLeft,t.offsetTop),o=L.point(t.clientWidth,t.clientHeight);return(0===o.x||0===o.y)&&window.console&&console.error("The viewport has no size. Check your CSS."),L.bounds(e,e.add(o))},getViewportLatLngBounds:function(){var t=this.getViewportBounds();return L.latLngBounds(this.containerPointToLatLng(t.min),this.containerPointToLatLng(t.max))},getOffset:function(){var t=this.getSize().divideBy(2),e=this.getViewportBounds().getCenter();return t.subtract(e)},getCenter:function(){var t=leafletActiveAreaPreviousMethods.getCenter.call(this);if(this.getViewport()){var e=this.getZoom(),o=this.project(t,e);o=o.subtract(this.getOffset()),t=this.unproject(o,e)}return t},setView:function(t,e,o){if(t=L.latLng(t),this.getViewport()){var i=this.project(t,e);i=i.add(this.getOffset()),t=this.unproject(i,e)}return leafletActiveAreaPreviousMethods.setView.call(this,t,e,o)},setZoomAround:function(t,e,o){var i=this.getViewport();if(i){var n=this.getZoomScale(e),a=this.getViewportBounds().getCenter(),s=t instanceof L.Point?t:this.latLngToContainerPoint(t),r=s.subtract(a).multiplyBy(1-1/n),l=this.containerPointToLatLng(a.add(r));return this.setView(l,e,{zoom:o})}return leafletActiveAreaPreviousMethods.setZoomAround.call(this,point,e,o)},getBoundsZoom:function(t,e,o){t=L.latLngBounds(t);var h,i=this.getMinZoom()-(e?1:0),n=this.getMaxZoom(),a=this.getViewport(),s=a?L.point(a.clientWidth,a.clientHeight):this.getSize(),r=t.getNorthWest(),l=t.getSouthEast(),c=!0;o=L.point(o||[0,0]);do i++,h=this.project(l,i).subtract(this.project(r,i)).add(o),c=e?h.x<s.x||h.y<s.y:s.contains(h);while(c&&n>=i);return c&&e?null:e?i:i-1}}),L.Map.include({setActiveArea:function(t){var e=this.getContainer();return this._viewport=L.DomUtil.create("div",""),e.insertBefore(this._viewport,e.firstChild),"string"==typeof t?this._viewport.className=t:L.extend(this._viewport.style,t),this}});